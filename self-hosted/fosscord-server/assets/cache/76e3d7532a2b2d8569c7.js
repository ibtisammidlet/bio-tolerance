"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[53145],{770549:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=void 0;var r=i(n(636602)),a=i(n(594506)),u=i(n(563621)),l=n(771425),o=n(840433);function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,u=[],l=!0,o=!1;try{for(n=n.call(e);!(l=(r=n.next()).done);l=!0){u.push(r.value);if(t&&u.length===t)break}}catch(e){o=!0;a=e}finally{try{l||null==n.return||n.return()}finally{if(o)throw a}}return u}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)
}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f={open:function(e){r.default.dispatch({type:"NOTIFICATION_SETTINGS_MODAL_OPEN",guildId:e})},close:function(){r.default.dispatch({type:"NOTIFICATION_SETTINGS_MODAL_CLOSE"})},updateGuildNotificationSettings:function(e,t,n){a.default.saveUserGuildSettings(e,t);r.default.dispatch({type:"USER_GUILD_SETTINGS_GUILD_UPDATE",guildId:e,settings:t});(0,l.trackGuildNotificationSettingsUpdate)(e,t,n)},updateGuildAndChannelNotificationSettings:function(e,t,n){a.default.saveUserGuildSettings(e,t);r.default.dispatch({type:"USER_GUILD_SETTINGS_GUILD_UPDATE",guildId:e,settings:t});(0,l.trackGuildNotificationSettingsUpdate)(e,t,n);Object.keys(t.channel_overrides).forEach((function(r){return(0,
l.trackChannelNotificationSettingsUpdate)(e,r,t.channel_overrides[r],n)}))},updateGuildNotificationSettingsBulk:function(e,t){a.default.saveUserGuildSettingsBulk(e);Object.entries(e).forEach((function(e){var n=s(e,2),a=n[0],u=n[1];r.default.dispatch({type:"USER_GUILD_SETTINGS_GUILD_UPDATE",guildId:a,settings:u});(0,l.trackGuildNotificationSettingsUpdate)(a,u,t)}))},updateChannelOverrideSettings:function(e,t,n,u){var o,i={channel_overrides:(o={},o[t]=n,o)};a.default.saveUserGuildSettings(e,i);r.default.dispatch({type:"USER_GUILD_SETTINGS_CHANNEL_UPDATE",guildId:e,channelId:t,settings:n});(0,l.trackChannelNotificationSettingsUpdate)(e,t,n,u)},updateChannelOverrideSettingsBulk:function(e,t,n){var u={channel_overrides:t};a.default.saveUserGuildSettings(e,u);r.default.dispatch({type:"USER_GUILD_SETTINGS_CHANNEL_UPDATE_BULK",guildId:e,overrides:t});Object.keys(t).forEach((function(r){return(0,l.trackChannelNotificationSettingsUpdate)(e,r,t[r],n)}))},setForumThreadsCreated:function(e,t){
var n=t?o.ChannelNotificationSettingsFlags.NEW_FORUM_THREADS_ON:o.ChannelNotificationSettingsFlags.NEW_FORUM_THREADS_OFF,r=t?o.ChannelNotificationSettingsFlags.NEW_FORUM_THREADS_OFF:o.ChannelNotificationSettingsFlags.NEW_FORUM_THREADS_ON,a=u.default.getChannelFlags(e)&~r|n;this.updateChannelOverrideSettings(e.guild_id,e.id,{flags:a})}};t.default=f},441224:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=t.SearchBarIcon=t.RichTagTypes=void 0;var r,a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=y(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var l=a?Object.getOwnPropertyDescriptor(e,u):null;l&&(l.get||l.set)?Object.defineProperty(r,u,l):r[u]=e[u]}r.default=e;n&&n.set(e,r);return r
}(n(667294)),u=_(n(294184)),l=_(n(213192)),o=_(n(314234)),i=_(n(151097)),s=_(n(16941)),d=_(n(259530)),f=_(n(348763)),c=_(n(628551)),p=_(n(582945)),h=n(518802),g=n(770348),v=_(n(247001)),m=_(n(544064));function _(e){return e&&e.__esModule?e:{default:e}}function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(y=function(e){return e?n:t})(e)}function S(){S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return S.apply(this,arguments)}function E(e,t){E=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return E(e,t)}function T(e,t,n,a){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var u=e&&e.defaultProps,l=arguments.length-3;if(t||0===l||(t={children:void 0}),1===l)t.children=a;else if(l>1){for(var o=new Array(l),i=0;i<l;i++)o[i]=arguments[i+3];t.children=o}
if(t&&u)for(var s in u)void 0===t[s]&&(t[s]=u[s]);else t||(t=u||{});return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var b=Object.freeze({SMALL:m.default.small,MEDIUM:m.default.medium,LARGE:m.default.large}),C=(0,l.default)({MEMBER:null,ROLE:null,CHANNEL:null});t.RichTagTypes=C;var O=function(e){var t,n,r,a=e.hasContent,l=e.onClear,o=e.className,i=e.themeOverride,c=e.size,p=void 0===c?b.SMALL:c;return T(s.default,{className:(0,u.default)(o,m.default.iconLayout,p,(0,h.getThemeClass)(i),(t={},t[m.default.clear]=a,t)),onClick:function(e){e.stopPropagation();null!=l&&l(e)},onMouseDown:function(e){e.preventDefault();e.stopPropagation()},tabIndex:a?0:-1,"aria-hidden":!a,"aria-label":v.default.Messages.SEARCH_CLEAR,focusProps:{offset:4}},void 0,T("div",{className:m.default.iconContainer},void 0,T(f.default,{className:(0,u.default)((n={},n[m.default.icon]=!0,n[m.default.visible]=!a,n))}),T(d.default,{className:(0,u.default)((r={},r[m.default.icon]=!0,
r[m.default.visible]=a,r))})))};t.SearchBarIcon=O;O.displayName="SearchBarIcon";var I=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;E(e,t)}(t,e);function t(){for(var t,n=arguments.length,r=new Array(n),u=0;u<n;u++)r[u]=arguments[u];(t=e.call.apply(e,[this].concat(r))||this).defaultInputProps={role:"combobox","aria-haspopup":"listbox","aria-autocomplete":"list"};t.ref=a.createRef();t.containerRef=a.createRef();t.handleKeyDown=function(e){var n=t.props,r=n.onActivate,a=n.onKeyDown,u=n.onQueryChange,l=n.useKeyboardNavigation;null!=a&&a(e);var o=t.ref.current;if(null!=o&&null==r)if(e.keyCode===g.KeyboardKeys.ESCAPE&&null!=o.value&&""!==o.value&&o.value.length>0){o.value="";null!=u&&u("")}else l&&(t.props.gridResults?t.handleKeyDownGrid(e):t.handleKeyDownList(e));else e.keyCode!==g.KeyboardKeys.TAB&&null!=r&&r(e)};t.handleChange=function(e){var n=t.props.onQueryChange;null!=n&&n(e.currentTarget.value)};t.handleFocus=function(e){
var n=t.props.onFocus;null!=n&&n(e)};t.handleClear=function(){var e=t.props.onClear,n=t.ref.current;null!=e&&e();null!=n&&n.focus()};t.handleRemoveTag=function(e){var n=t.props.onRemoveTag;null==n||n(e)};t.focus=function(){var e=t.ref.current;null!=e&&e.focus()};return t}var n=t.prototype;n.componentDidUpdate=function(e){var t=this.props,n=t.focusAfterReady,r=t.isReady;n&&!e.isReady&&r&&this.focus()};n.handleKeyDownGrid=function(e){var t=this.props,n=t.selectedRow,r=t.selectedColumn,a=t.sections,u=t.query,l=t.tags,o=t.onSelectionChange,i=t.onSelect,s=t.onRemoveTag,d=t.preventEscapePropagation;if(0!==a.length){switch(e.keyCode){case g.KeyboardKeys.BACKSPACE:if((null==u||0===u.length)&&null!=l&&l.length>0){e.preventDefault();e.stopPropagation();null==s||s(l.length-1)}break;case g.KeyboardKeys.ARROW_DOWN:e.preventDefault();e.stopPropagation();if(-1===n){n=0;r=0}else{(n+=1)>=a.length&&(n=a.length-1);r>=a[n]&&(r=a[n]-1)}break;case g.KeyboardKeys.ARROW_UP:e.preventDefault()
;e.stopPropagation();if((n-=1)<0){n=0;r=0}else r>=a[n]&&(r=a[n]-1);break;case g.KeyboardKeys.ARROW_LEFT:e.preventDefault();e.stopPropagation();-1===n&&(n=0);if((r-=1)<0)if((n-=1)>=0)r=a[n]-1;else if(n<0){n=0;r=0}break;case g.KeyboardKeys.ARROW_RIGHT:e.preventDefault();e.stopPropagation();-1===n&&(n=0);if((r+=1)>=a[n]){r=0;(n+=1)>=a.length&&(r=a[n=a.length-1]-1)}break;case g.KeyboardKeys.ENTER:e.preventDefault();e.stopPropagation();-1===n&&(n=0);-1===r&&(r=0);if(n>=a.length||r>=a[n])return;null!=i&&i(n,r,e);return;case g.KeyboardKeys.ESCAPE:e.preventDefault();d&&e.stopPropagation();null!=i&&i(null,null,e);return;default:return}null!=o&&o(n,r)}};n.handleKeyDownList=function(e){var t=this.props,n=t.sections,r=t.selectedSection,a=t.selectedRow,u=t.onSelect,l=t.onSelectionChange,o=t.query,i=t.tags,s=t.preventEscapePropagation,d=this.ref.current;if(null!=d)switch(e.keyCode){case g.KeyboardKeys.BACKSPACE:if((null==o||0===o.length)&&null!=i&&i.length>0){var f,c;e.preventDefault()
;e.stopPropagation();null===(f=(c=this.props).onRemoveTag)||void 0===f||f.call(c,i.length-1)}break;case g.KeyboardKeys.ARROW_DOWN:e.preventDefault();e.stopPropagation();if(n.length>r&&++a>=n[r]){++r>=n.length&&(r=0);a=0}null==l||l(r,a);break;case g.KeyboardKeys.ARROW_UP:e.preventDefault();e.stopPropagation();if(--a<0){--r<0&&(r=n.length-1);a=n[r]-1}null==l||l(r,a);break;case g.KeyboardKeys.ENTER:e.preventDefault();e.stopPropagation();n.length>r&&n[r]>a&&(null==u||u(r,a,e));break;case g.KeyboardKeys.ESCAPE:e.preventDefault();s&&e.stopPropagation();null==u||u(null,null,e);d.blur()}};n.render=function(){var e,t,n=this,r=this.props,l=r.autoFocus,s=r.query,f=r.placeholder,g=void 0===f?v.default.Messages.DM_SEARCH_PLACEHOLDER:f,_=r.themeOverride,y=r.disabled,E=r.onClear,b=r.size,I=r.maxHeight,A=r.tags,M=r.onActivate,N=r.className,R=r.inputProps,P=r.focusAfterReady,U=null!=s&&s.length>0,w=!1,D=[];if(null!=A&&A.length>0)if("string"==typeof A[0]){A.forEach((function(e,t){
return D.push(T(i.default,{focusProps:{offset:4},className:m.default.tag,onClick:n.handleRemoveTag.bind(n,t)},t,e,T(d.default,{className:m.default.close,"aria-label":v.default.Messages.REMOVE})))}))}else{w=!0;A.forEach((function(e,t){return D.push(T(i.default,{className:(0,u.default)(m.default.tag,m.default.richTag),onClick:n.handleRemoveTag.bind(n,t)},t,e.type===C.MEMBER&&e.avatar&&T(c.default,{src:e.avatar,"aria-hidden":!0,size:c.default.Sizes.SIZE_16}),e.type===C.ROLE&&e.color&&T("span",{className:m.default.tagRoleColor,style:{backgroundColor:e.color}}),T("span",{className:m.default.tagLabel},void 0,e.label),T(d.default,{className:m.default.close,"aria-label":v.default.Messages.REMOVE})))}))}return T(o.default,{focusTarget:this.ref,ringTarget:this.containerRef},void 0,a.createElement("div",{ref:this.containerRef,className:(0,u.default)(N,m.default.container,b,(0,h.getThemeClass)(_),(e={},e[m.default.disabled]=y,e))},T(p.default,{className:m.default.inner,style:{maxHeight:I}
},void 0,D,a.createElement("input",S({className:(0,u.default)(m.default.input,(t={},t[m.default.richTagInput]=w,t)),type:"text",ref:this.ref,spellCheck:"false",placeholder:g,value:s,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,disabled:y,"aria-disabled":y,autoFocus:!P&&l,onMouseDown:M},this.defaultInputProps,R)),null!=E?T(O,{size:b,themeOverride:_,hasContent:U,onClear:this.handleClear}):null)))};return t}(a.Component);I.displayName="SearchBar";I.Sizes=b;I.defaultProps={size:b.SMALL,query:"",sections:[],selectedSection:0,selectedRow:-1,selectedColumn:-1,gridResults:!1,disabled:!1,autoFocus:!1,preventEscapePropagation:!0,useKeyboardNavigation:!0};var A=I;t.default=A},973523:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.GuildForumExperiment=void 0;t.getEnableForumPermissions=function(e){return D.getCurrentConfig({guildId:e}).enabled};t.useAppliedTags=function(e){var t=L(e);return null==e||null==t?[]:e.appliedTags.map((function(e){
return null==t?void 0:t[e]})).filter((function(e){return null!=e}))};t.useAvailableTags=L;t.useCanCreateForumChannel=function(e){return F(e)};t.useCanManageChannel=function(e){return(0,l.useStateFromStores)([y.default],(function(){return y.default.can(M.Permissions.MANAGE_CHANNELS,e)}))};t.useChannelTemplate=function(e){return r.useMemo((function(){return null==e||null==e.template?"":e.template.trim()}),[e])};t.useDefaultReactionEmoji=function(e){var t,n=null==e?void 0:e.defaultReactionEmoji,r=(0,l.useStateFromStores)([m.default],(function(){return null!=(null==n?void 0:n.emojiId)?m.default.getUsableCustomEmojiById(n.emojiId):null}));if(null==n)return null;null!=n.emojiId&&null!=r?t={id:n.emojiId,name:r.name,animated:r.animated}:null!=n.emojiName&&(t={id:n.emojiId,name:n.emojiName,animated:!1});return t};t.useExistingPin=function(e){var t=(0,l.useStateFromStoresObject)([c.default],(function(){return c.default.getThreadsForParent(e.guild_id,e.parent_id)}),[e.guild_id]);return(0,
a.default)(t).values().map((function(e){var t=e.id;return v.default.getChannel(t)})).filter(C.isNotNullish).find((function(e){return e.hasFlag(N.ChannelFlags.PINNED)}))};t.useFacepileUsers=function(e,t){var n=(0,l.useStateFromStoresArray)([b.default],(function(){return t.map((function(e){return b.default.getUser(e)}))}));r.useEffect((function(){t.filter((function(e,t){return null==n[t]})).forEach((function(t){_.default.requestMember(e.guild_id,t)}))}),[]);return n};t.useFirstAppliedTag=function(e){var t=L(e);return r.useMemo((function(){var n=e.appliedTags.map((function(e){return null==t?void 0:t[e]})).filter(C.isNotNullish);return[n[0],n.length-1]}),[t,e.appliedTags])};t.useForumPostCreator=function(e){var t=(0,l.useStateFromStores)([b.default],(function(){return b.default.getUser(e.ownerId)})),n=(0,d.useNullableUserAuthor)(t,e);r.useEffect((function(){null!=e.ownerId&&_.default.requestMember(e.guild_id,e.ownerId)}),[e.guild_id,e.ownerId]);return{user:t,author:n}}
;t.useForumPostMarkup=function(e){var t=r.useMemo((function(){return null!=(null==e?void 0:e.content)&&""!==e.content?(0,s.default)(e,{formatInline:!0,noStyleAndInteraction:!0,allowHeading:!0,allowList:!0}):{hasSpoilerEmbeds:!1,content:null}}),[e]),n=t.hasSpoilerEmbeds,a=t.content,u=(0,I.useFindFirstMediaProperties)(e,n);return{hasSpoilerEmbeds:n,content:a,firstMedia:u}};t.useForumPostReadStates=function(e,t){return(0,l.useStateFromStoresObject)([S.default],(function(){return{isNew:!e.isArchivedThread()&&S.default.isNewForumThread(e.id,e.parent_id,t),hasUnreads:!e.isArchivedThread()&&S.default.isForumPostUnread(e.id,t)}}))};t.useForumThreadsForChannelList=function(e){var t=(0,l.useStateFromStoresObject)([f.default],(function(){return{activeJoinedThreads:f.default.getActiveJoinedThreadsForGuild(e),activeUnjoinedThreads:f.default.getActiveUnjoinedThreadsForGuild(e),newThreadCounts:f.default.getNewThreadCountsForGuild(e)}
})),n=t.activeJoinedThreads,r=t.activeUnjoinedThreads,a=t.newThreadCounts;return{activeJoinedThreads:n,activeUnjoinedThreads:r,newThreadCounts:a}};t.useIsForumExperimentEnabled=F;t.useLastActiveTimestamp=function(e,t){var n=u.default.extractTimestamp((0,l.useStateFromStores)([S.default],(function(){return S.default.lastMessageId(e.id)}))),r=u.default.extractTimestamp(e.id);return t===R.SortOrder.Creation?(0,g.getTimestampString)(r):(0,g.getTimestampString)(n)};t.useLoadForumUnreadCounts=function(e,t){var n=(0,l.useStateFromStores)([c.default],(function(){return c.default.hasLoaded(e.guild_id)}));r.useEffect((function(){if(n){var r=O.default.getThreadIds(e.id,t),a=A.default.getThreadIdsMissingCounts(e.guild_id,r.map((function(e){return e.channelId}))).filter((function(e){return null!=S.default.getTrackedAckMessageId(e)})).map((function(e){return{threadId:e,ackMessageId:S.default.getTrackedAckMessageId(e)}}));a.length>0&&o.default.dispatch({type:"REQUEST_FORUM_UNREADS",
guildId:e.guild_id,channelId:e.id,threads:a})}}),[e.id,e.guild_id,n,t])};t.useMessageCount=function(e){var t=(0,l.useStateFromStores)([h.default],(function(){var t;return null!==(t=h.default.getCount(e.id))&&void 0!==t?t:0})),n=(0,p.renderMessageCount)(t,e.id),r=(0,l.useStateFromStores)([S.default],(function(){return S.default.hasTrackedUnread(e.id)})),a=(0,l.useStateFromStores)([S.default],(function(){return S.default.hasOpenedThread(e.id)})),u=(0,l.useStateFromStores)([A.default],(function(){if(!a||!r)return null;var t=A.default.getCount(e.id);return null!=t&&t>0?t>=R.MAX_THREAD_UNREAD_MESSAGE_COUNT?R.MAX_THREAD_UNREAD_MESSAGE_COUNT+"+":t:"1+"}));return{messageCount:n,unreadCount:u}};t.useMostUsedReaction=function(e){var t,n,r,u=a.default.sortBy(null!==(t=null==e?void 0:e.reactions)&&void 0!==t?t:[],"count").reverse()[0],l=null!==(n=null==u?void 0:u.emoji)&&void 0!==n?n:G,o=null!==(r=null==u?void 0:u.count)&&void 0!==r?r:0;return{emoji:l,count:o,reaction:u}}
;t.useTypingUserIds=function(e){return(0,l.useStateFromStoresArray)([T.default,b.default,E.default],(function(){var t=b.default.getCurrentUser();return(0,a.default)(T.default.getTypingUsers(e.id)).keys().filter((function(e){return e!==(null==t?void 0:t.id)})).reject(E.default.isBlocked).map((function(e){return b.default.getUser(e)})).filter(C.isNotNullish).map((function(e){return e.id})).value()}))};t.useVisibleForumTags=function(e){var t=(0,l.useStateFromStores)([y.default],(function(){return y.default.can(M.Permissions.MANAGE_THREADS,e)}));return r.useMemo((function(){return t?e.availableTags:e.availableTags.filter((function(e){return!e.moderated}))}),[t,e.availableTags])};var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=U(t);if(n&&n.has(e))return n.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){
var l=a?Object.getOwnPropertyDescriptor(e,u):null;l&&(l.get||l.set)?Object.defineProperty(r,u,l):r[u]=e[u]}r.default=e;n&&n.set(e,r);return r}(n(667294)),a=P(n(496486)),u=P(n(795715)),l=n(536211),o=P(n(636602)),i=P(n(822350)),s=P(n(116518)),d=n(907932),f=P(n(19566)),c=P(n(782270)),p=n(93655),h=P(n(979674)),g=n(566142),v=P(n(644263)),m=P(n(433385)),_=P(n(737483)),y=P(n(689389)),S=P(n(191391)),E=P(n(290629)),T=P(n(946447)),b=P(n(728429)),C=n(71246),O=P(n(408643)),I=n(140092),A=P(n(962935)),M=n(770348),N=n(173652),R=n(64072);function P(e){return e&&e.__esModule?e:{default:e}}function U(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(U=function(e){return e?n:t})(e)}function w(){w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return w.apply(this,arguments)}var D=(0,i.default)({id:"2021-07_threads_only_channel",label:"Threads only channel",
kind:"guild",defaultConfig:{enabled:!1},treatments:[{id:1,label:"On",config:{enabled:!0}}]});t.GuildForumExperiment=D;function F(e){return D.useExperiment({guildId:e}).enabled}function L(e){var t=null==e?void 0:e.parent_id,n=(0,l.useStateFromStores)([v.default],(function(){return v.default.getChannel(t)}),[t]);return r.useMemo((function(){var e;return null==n||null===(e=n.availableTags)||void 0===e?void 0:e.reduce((function(e,t){var n;return w({},e,((n={})[t.id]=t,n))}),{})}),[null==n?void 0:n.availableTags])}var G={id:null,name:"👍"}},140092:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.isValidImageAttachment=f;t.isValidVideoAttachment=c;t.shouldShowAddMediaToOriginalPostModal=function(e,t){var n,a=u.default.getChannel(t);if(null==a)return!1;var i=l.default.getMessage(a.id,a.id);return null!=i&&(e.length>0&&null!=e.find((function(e){return e.isImage||e.isVideo
}))&&a.isForumPost()&&a.ownerId===(null===(n=o.default.getCurrentUser())||void 0===n?void 0:n.id)&&0===r.default.getCount(a.id)&&(0===i.attachments.length||null==i.attachments.find((function(e){return f(e)||c(e)}))))};t.useFindFirstMediaProperties=function(e,t){var n,r=a.InlineAttachmentMedia.useSetting(),u=a.InlineEmbedMedia.useSetting(),l=a.RenderEmbeds.useSetting();if(null==e)return null;var o=r?null===(n=e.attachments)||void 0===n?void 0:n.find((function(e){return f(e)||c(e)})):null;if(null!=o){var s=o.proxy_url,p=o.url,h=o.description,g=o.spoiler,v=o.width,m=o.height,_=o.filename;return null==v||null==m?null:{src:i.VIDEO_RE.test(_)?s+"?format=jpeg":null!=s?s:p,width:v,height:m,spoiler:null!=g&&g,alt:h}}if(!u||!l)return null;if(null==e.embeds)return null;for(var y,S=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t)
;var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e.embeds);!(y=S()).done;){var E,T=y.value,b=null!==(E=T.image)&&void 0!==E?E:T.thumbnail;null==b&&null!=T.images&&(b=T.images[0]);if(null!=b&&null!=b.url){var C=b,O=C.height,I=C.proxyURL,A=C.url,M=C.width;return{src:null!=I&&""!==I?I:A,height:O,width:M,spoiler:t}}}return null};var r=s(n(979674)),a=n(894826),u=s(n(644263)),l=s(n(201292)),o=s(n(728429)),i=n(100678);function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){(null==t||t>e.length)&&(t=e.length)
;for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){if(null==e)return!1;var t=e.filename,n=e.height,r=e.width;return i.IMAGE_RE.test(t)&&null!=n&&n>0&&null!=r&&r>0}function c(e){return null!=e&&(null!=e&&i.VIDEO_RE.test(e.filename)&&null!=e.proxy_url)}},962935:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=void 0;var r=s(n(441143)),a=s(n(536211)),u=s(n(636602)),l=s(n(782270)),o=s(n(644263)),i=s(n(191391));function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){d=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return d(e,t)}var f={},c=new Set;var p=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;d(e,t)}(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.initialize=function(){this.waitFor(l.default,o.default,i.default)};n.getCount=function(e){return f[e]};n.getThreadIdsMissingCounts=function(e,t){(0,
r.default)(l.default.hasLoaded(e),"must wait for THREAD_LIST_SYNC before calling this");return t.filter((function(e){return!(e in f)&&!c.has(e)}))};n.__getLocalVars=function(){return{counts:f,loadingThreadIds:c}};return t}(a.default.Store);p.displayName="ForumPostUnreadCountStore";var h=new p(u.default,{CONNECTION_OPEN:function(){f={};c=new Set},THREAD_CREATE:function(e){var t=e.channel;if(!e.isNewlyCreated)return!1;if(!l.default.hasLoaded(t.guild_id))return!1;f[t.id]=0},MESSAGE_CREATE:function(e){var t=e.channelId,n=e.optimistic,r=e.isPushNotification;if(n||r)return!1;if(!(t in f))return!1;f[t]++},FORUM_UNREADS:function(e){e.threads.forEach((function(e){null!=e.count&&(f[e.threadId]=e.count)}))},MESSAGE_ACK:function(e){var t=e.channelId;if(!(t in f)){var n=o.default.getChannel(t),r=o.default.getChannel(null==n?void 0:n.parent_id);if(!(null==r?void 0:r.isForumChannel()))return!1}f[t]=i.default.getUnreadCount(t)},REQUEST_FORUM_UNREADS:function(e){e.threads.forEach((function(e){
var t=e.threadId;return c.add(t)}))}});t.default=h},93655:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.shouldUseOldMaxMessageCount=t.renderMessageCount=t.formatMobileMessageCountLabel=t.formatMessageCountLabel=void 0;var r=l(n(71636)),a=n(64072),u=l(n(247001));function l(e){return e&&e.__esModule?e:{default:e}}var o=function(e){return r.default.compare("992549565104128000",e)>-1};t.shouldUseOldMaxMessageCount=o;var i=function(e,t){if(null==e||e<0)return"0";var n=o(t);return(null==t||n)&&e>=a.MAX_THREAD_MESSAGE_COUNT_OLD?"50+":e>=a.MAX_THREAD_MESSAGE_COUNT?"100k+":""+e};t.renderMessageCount=i;var s=function(e,t,n){var r=i(e,n);return"0"===r?u.default.Messages.SEE_THREAD:t.format({count:r})};t.formatMobileMessageCountLabel=function(e,t){return s(e,u.default.Messages.THREAD_MESSAGE_COUNT_MOBILE,t)};t.formatMessageCountLabel=function(e,t){return s(e,u.default.Messages.THREAD_MESSAGE_COUNT,t)}},594506:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0})
;t.default=void 0;var r=d(n(496486)),a=d(n(118915)),u=d(n(636602)),l=d(n(791548)),o=d(n(881454)),i=d(n(644263)),s=n(770348);function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,r,a,u,l){try{var o=e[u](l),i=o.value}catch(e){n(e);return}o.done?t(i):Promise.resolve(i).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var u=e.apply(t,n);function l(e){f(u,r,a,l,o,"next",e)}function o(e){f(u,r,a,l,o,"throw",e)}l(void 0)}))}}function p(){p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return p.apply(this,arguments)}var h={},g=new l.default("UserGuildSettingsManager"),v=0;function m(){h=p({},o.default.getCollapsedCategories())}function _(){if(!__OVERLAY__){clearTimeout(v);v=setTimeout((function(){return y()}),15e3)}}function y(e,t){return S.apply(this,arguments)}function S(){
return(S=c(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;return E(null!=n?((r={})[null!=t?t:s.ME]=n,r):{});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return T.apply(this,arguments)}function T(){return(T=c(regeneratorRuntime.mark((function e(t){var n,u,l,d,f,c,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearTimeout(v);n=0!==Object.keys(t).length;u=o.default.getCollapsedCategories();l=b();for(d in l)if(null!=(f=i.default.getChannel(d))&&null!=f.guild_id){f.guild_id in t||(t[f.guild_id]={});null==t[f.guild_id].channel_overrides&&(t[f.guild_id].channel_overrides={});t[f.guild_id].channel_overrides[f.id]=p({},t[f.guild_id].channel_overrides[f.id],{collapsed:f.id in u});n=!0}if(n){e.next=7;break}return e.abrupt("return");case 7:h=p({},u);c=r.default.map(t,(function(e,t){return{guildId:t,updates:e,attempts:0}}));case 9:
if(!(c.length>0)){e.next=29;break}if((m=c.shift()).guildId!==s.FAVORITES){e.next=13;break}return e.abrupt("continue",9);case 13:e.prev=13;e.next=16;return a.default.patch({url:s.Endpoints.USER_GUILD_SETTINGS(m.guildId),body:m.updates});case 16:e.next=18;return C(1e3);case 18:e.next=27;break;case 20:e.prev=20;e.t0=e.catch(13);g.error(e.t0);m.attempts+=1;m.attempts<3&&c.push(m);e.next=27;return C(5e3);case 27:e.next=9;break;case 29:case"end":return e.stop()}}),e,null,[[13,20]])})))).apply(this,arguments)}function b(){var e={},t=o.default.getCollapsedCategories();for(var n in t)t[n]!==h[n]&&(e[n]=!0);for(var r in h)t[r]!==h[r]&&(e[r]=!0);return e}function C(e){return new Promise((function(t){return setTimeout(t,e+Math.ceil(e*Math.random()))}))}function O(){h=p({},o.default.getCollapsedCategories())}var I={init:function(){u.default.subscribe("CATEGORY_COLLAPSE",_);u.default.subscribe("CATEGORY_EXPAND",_);u.default.subscribe("CATEGORY_COLLAPSE_ALL",_)
;u.default.subscribe("CATEGORY_EXPAND_ALL",_);u.default.subscribe("CONNECTION_OPEN",m);u.default.subscribe("USER_GUILD_SETTINGS_FULL_UPDATE",O)},saveUserGuildSettings:y,saveUserGuildSettingsBulk:E};t.default=I},946447:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=void 0;var r=s(n(536211)),a=s(n(118915)),u=s(n(636602)),l=s(n(423046)),o=n(249875),i=n(770348);function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t){d=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return d(e,t)}function f(){f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};return f.apply(this,arguments)}var c,p={},h=Object.freeze({});function g(e){var t;return null!==(t=p[e])&&void 0!==t?t:h}function v(e){var t=e.channelId,n=e.userId,r=f({},g(t));clearTimeout(r[n]);r[n]=function(e,t){return setTimeout((function(){u.default.dispatch({type:"TYPING_STOP",channelId:e,
userId:t})}),i.TYPING_TIMEOUT)}(t,n);p[t]=r}function m(e){var t=e.channelId,n=e.userId,r=p[t];if(null==r||null==r[n])return!1;var a=f({},r);clearTimeout(a[n]);delete a[n];p[t]=a}function _(){p={}}var y=function(e){!function(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;d(e,t)}(t,e);function t(){return e.apply(this,arguments)||this}var n=t.prototype;n.getTypingUsers=function(e){return g(e)};n.isTyping=function(e,t){return null!=g(e)[t]};n.__getLocalVars=function(){return{typingUsersByChannel:p,localTypingDelay:c,EMPTY_TYPING:h}};return t}(r.default.Store);y.displayName="TypingStore";var S=new y(u.default,{TYPING_START:v,TYPING_STOP:m,TYPING_START_LOCAL:function(e){var t=e.channelId,n=l.default.getId();if(null==n)return!1;if(null!=c&&c.channelId!==t){null!=c.timeout&&clearTimeout(c.timeout);c=null}var r=Date.now(),s=.8*i.TYPING_TIMEOUT;if(null!=c&&(null!=c.timeout||c.prevSend+s>r))return!1
;var d=null==c||c.prevSend>r-2*s?i.TYPING_DELAY_LOCAL:0,f=setTimeout((function(){if(null!=c&&c.channelId===t&&n===l.default.getId()&&null!=c.timeout){c.timeout=null;(function(e){var t=g(e);return t===h?0:Object.keys(t).length})(t)>i.MAX_TYPING_USERS||a.default.post({url:i.Endpoints.TYPING(t),oldFormErrors:!0}).then((function(e){if(200===e.status){var n,r,a=null!==(n=e.body.message_send_cooldown_ms)&&void 0!==n?n:0,l=null!==(r=e.body.thread_create_cooldown_ms)&&void 0!==r?r:0;a>0&&u.default.dispatch({type:"SLOWMODE_SET_COOLDOWN",channelId:t,slowmodeType:o.SlowmodeType.SendMessage,cooldownMs:a});l>0&&u.default.dispatch({type:"SLOWMODE_SET_COOLDOWN",channelId:t,slowmodeType:o.SlowmodeType.CreateThread,cooldownMs:l})}}))}}),d);c={channelId:t,timeout:f,prevSend:r};return v({channelId:t,userId:n})},TYPING_STOP_LOCAL:function(e){var t=e.channelId,n=l.default.getId();if(null==n)return!1;if(null!=c&&c.channelId===t&&null!=c.timeout){clearTimeout(c.timeout);c=null;return m({channelId:t,userId:n
})}return!1},CONNECTION_OPEN:_,OVERLAY_INITIALIZE:_,MESSAGE_CREATE:function(e){var t=e.channelId,n=e.message.author;e.optimistic&&function(e){if(null==c||c.channelId!==e)return!1;null!=c.timeout&&clearTimeout(c.timeout);c=null}(t);return m({channelId:t,userId:n.id})}});t.default=S}}]);
//# sourceMappingURL=76e3d7532a2b2d8569c7.js.map